(sid devnull)

(block dev

	;
	; Macros
	;

	(macro create_all_subj_type ((type ARG1))
		(typeattributeset create_all_subj_type_attribute
				ARG1))

	(macro dev_obj_type ((type ARG1))
		(typeattributeset dev_obj_type_attribute ARG1))

	(macro getattr_all_subj_type ((type ARG1))
		(typeattributeset getattr_all_subj_type_attribute
				ARG1))

	(macro login_pty ((type ARG1)(type ARG2))
		(typechange ARG1 login_pty_obj_type_attribute chr_file ARG2))

	(macro login_pty_obj_type ((type ARG1))
		(typeattributeset login_pty_obj_type_attribute ARG1))

	(macro manage_all_subj_type ((type ARG1))
		(typeattributeset manage_all_subj_type_attribute
				ARG1))

	(macro pty_obj_type ((type ARG1))
		(typeattributeset pty_obj_type_attribute ARG1))

	(macro read_all_subj_type ((type ARG1))
		(typeattributeset read_all_subj_type_attribute
			ARG1))

	(macro read_memory_subj_type ((type ARG1))
		(typeattributeset read_memory_subj_type_attribute
			ARG1))

	(macro relabel_all_subj_type ((type ARG1))
		(typeattributeset relabel_all_subj_type_attribute
			ARG1))

	(macro rw_all_subj_type ((type ARG1))
		(typeattributeset rw_all_subj_type_attribute
			ARG1))

	(macro serial_obj_type ((type ARG1))
		(typeattributeset serial_obj_type_attribute ARG1))

	(macro stor_obj_type ((type ARG1))
		(typeattributeset stor_obj_type_attribute ARG1))

	(macro setattr_all_subj_type ((type ARG1))
		(typeattributeset setattr_all_subj_type_attribute
			ARG1))

	(macro unconfined_subj_type ((type ARG1))
		(typeattributeset unconfined_subj_type_attribute
			ARG1))

	(macro write_all_subj_type ((type ARG1))
		(typeattributeset write_all_subj_type_attribute
			ARG1))

	(macro write_memory_subj_type ((type ARG1))
		(typeattributeset write_memory_subj_type_attribute
			ARG1))
	;
	; Policy
	;

	(typeattribute dev_obj_type_attribute)
	(typeattribute dev_except_stor_pty_and_serial_obj_type_attribute)
	(typeattribute login_pty_obj_type_attribute)
	(typeattribute pty_obj_type_attribute)
	(typeattribute serial_obj_type_attribute)
	(typeattribute create_all_subj_type_attribute)
	(typeattribute getattr_all_subj_type_attribute)
	(typeattribute manage_all_subj_type_attribute)
	(typeattribute
		not_read_memory_subj_type_or_unconfined_subj_type_attribute)
	(typeattribute
		not_write_memory_subj_type_or_unconfined_subj_type_attribute)
	(typeattribute read_all_subj_type_attribute)
	(typeattribute read_memory_subj_type_attribute)
	(typeattribute relabel_all_subj_type_attribute)
	(typeattribute rw_all_subj_type_attribute)
	(typeattribute setattr_all_subj_type_attribute)
	(typeattribute stor_obj_type_attribute)
	(typeattribute unconfined_subj_type_attribute)
	(typeattribute write_all_subj_type_attribute)
	(typeattribute write_memory_subj_type_attribute)

	(call sys.sys_obj_type (dev_obj_type_attribute))

	(call fs.devtmpfs.associate_obj_type (dev_obj_type_attribute))

	(typeattributeset
		not_read_memory_subj_type_or_unconfined_subj_type_attribute
			(not (read_memory_subj_type_attribute
				unconfined_subj_type_attribute)))

	(neverallow
		not_read_memory_subj_type_or_unconfined_subj_type_attribute
			dev.memory.dev (chr_file (read)))

	(typeattributeset
		not_write_memory_subj_type_or_unconfined_subj_type_attribute
			(not (write_memory_subj_type_attribute
				unconfined_subj_type_attribute)))

	(neverallow
		not_write_memory_subj_type_or_unconfined_subj_type_attribute
			dev.memory.dev (chr_file (append write)))

	(call dev.clock.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.cuse.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.devtty.tmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.event.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.kvm.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.mei_misc.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.mouse.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.null.tmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.random.tmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.sound.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.tpm.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.urandom.tmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.usb.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.v4l.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.watchdog.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.wireless.devtmpfs_obj_type_transition
		(unconfined_subj_type_attribute))
	(call dev.zero.tmpfs_obj_type_transition
		(unconfined_subj_type_attribute))

	(typeattributeset dev_obj_type_attribute (stor_obj_type_attribute
		(login_pty_obj_type_attribute pty_obj_type_attribute
			serial_obj_type_attribute)))

	(typeattributeset dev_except_stor_pty_and_serial_obj_type_attribute
		(and (dev_obj_type_attribute)
		(not (stor_obj_type_attribute login_pty_obj_type_attribute
			pty_obj_type_attribute serial_obj_type_attribute))))

	(allow create_all_subj_type_attribute self (capability (mknod)))
	(allow create_all_subj_type_attribute
		dev_except_stor_pty_and_serial_obj_type_attribute
			create_chr_file_perms)

	(allow
		getattr_all_subj_type_attribute
			dev_except_stor_pty_and_serial_obj_type_attribute
				(chr_file (getattr)))

	(allow manage_all_subj_type_attribute self (capability (mknod)))
	(allow manage_all_subj_type_attribute
		dev_except_stor_pty_and_serial_obj_type_attribute
			manage_chr_file_perms)

	(allow read_all_subj_type_attribute
		dev_except_stor_pty_and_serial_obj_type_attribute
			read_chr_file_perms)
	(allow relabel_all_subj_type_attribute
		dev_except_stor_pty_and_serial_obj_type_attribute
			relabel_chr_file_perms)
	(allow rw_all_subj_type_attribute
		dev_except_stor_pty_and_serial_obj_type_attribute
			rw_chr_file_perms)
	(allow setattr_all_subj_type_attribute
		dev_except_stor_pty_and_serial_obj_type_attribute (chr_file
			(setattr)))
	(allow
		write_all_subj_type_attribute
			dev_except_stor_pty_and_serial_obj_type_attribute
				write_chr_file_perms)

	(call read_memory_subj_type
		(manage_all_subj_type_attribute))
	(call read_memory_subj_type (read_all_subj_type_attribute))
	(call read_memory_subj_type (rw_all_subj_type_attribute))

	(call write_memory_subj_type
		(manage_all_subj_type_attribute))
	(call write_memory_subj_type (rw_all_subj_type_attribute))
	(call write_memory_subj_type
		(write_all_subj_type_attribute))

	(allow unconfined_subj_type_attribute self (capability (sys_rawio)))
	(allow unconfined_subj_type_attribute
		dev_except_stor_pty_and_serial_obj_type_attribute
			chr_file_except_mounton_and_execmod)

	(block apm

		;
		; apm contexts
		;

		(filecon "/dev/snapshot" char dev_file_context)

		;
		; apm macros
		;

		;
		; apm policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block autofs

		;
		; autofs contexts
		;

		(filecon "/dev/autofs" char dev_file_context)

		;
		; autofs macros
		;

		;
		; autofs policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block clock

		;
		; clock contexts
		;

		(filecon "/dev/hpet" char dev_file_context)
		(filecon "/dev/ptp([0-9]+)?" char dev_file_context)
		(filecon "/dev/rtc([0-9]+)?" char dev_file_context)

		;
		; clock macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "ptp0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "ptp1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "ptp3")))

		;
		; clock policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block cpu

		;
		; cpu contexts
		;

		(filecon "/dev/cpu/.+" char dev_file_context)

		;
		; cpu macros
		;

		;
		; cpu policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block cuse

		;
		; cuse contexts
		;

		(filecon "/dev/cuse" char dev_file_context)

		;
		; cuse macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "cuse")))

		;
		; cuse policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block devtty

		;
		; devtty contexts
		;

		(filecon "/dev/tty" char dev_file_context)

		;
		; devtty macros
		;

		(macro tmpfs_obj_type_transition ((type ARG1))
			(call fs.tmpfs.obj_type_transition (ARG1 dev
				chr_file "tty")))

		;
		; devtty policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block dpaux

		;
		; dpaux contexts
		;

		(filecon "/dev/drm_dp_aux[0-9]+" char dev_file_context)

		;
		; dpaux macros
		;

		;
		; dpaux policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block dri

		;
		; dri contexts
		;

		(filecon "/dev/dri/.+" char dev_file_context)

		;
		; dri macros
		;

		;
		; dri policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block event

		;
		; event contexts
		;

		(filecon "/dev/input/event([0-9]+)?" char dev_file_context)
		(filecon "/dev/uinput" char dev_file_context)

		;
		; event macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event2"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event3"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event4"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event5"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event6"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event7"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event8"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event9"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event10"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event11"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event12"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event13"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event14"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event15"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event16"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event17"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event18"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event19"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "event20")))

		;
		; event policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block framebuf

		;
		; framebuf contexts
		;

		(filecon "/dev/fb([0-9]+)?" char dev_file_context)

		;
		; framebuf macros
		;

		;
		; framebuf policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block kmsg

		;
		; kmsg contexts
		;

		(filecon "/dev/kmsg" char dev_file_context)
		(filecon "/dev/mcelog" char dev_file_context)

		;
		; kmsg macros
		;

		;
		; kmsg policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block kvm

		;
		; kvm contexts
		;

		(filecon "/dev/kvm" char dev_file_context)

		;
		; kvm macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "kvm")))

		;
		; kvm policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block loop_control

		;
		; loop_control contexts
		;

		(filecon "/dev/loop-control" char dev_file_context)

		;
		; loop_control macros
		;

		;
		; loop_control policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block lvm_control

		;
		; lvm_control contexts
		;

		(filecon "/dev/btrfs-control" char dev_file_context)
		(filecon "/dev/mapper/control" char dev_file_context)

		;
		; lvm_control macros
		;

		;
		; lvm_control policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block mei_misc

		;
		; mei_misc contexts
		;

		(filecon "/dev/mei([0-9]+)?" char dev_file_context)

		;
		; mei_misc macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "mei0")))

		;
		; mei_misc policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block memory

		;
		; memory contexts
		;

		(filecon "/dev/mem" char dev_file_context)
		(filecon "/dev/port" char dev_file_context)

		;
		; memory macros
		;

		;
		; memory policy
		;

		(blockinherit dev.dev_obj_base_template)

		(typeattributeset read_memory_subj_type_attribute
			(manage_subj_type_attribute
				read_subj_type_attribute
					rw_subj_type_attribute))

		(typeattributeset write_memory_subj_type_attribute
			(manage_subj_type_attribute
				rw_subj_type_attribute
					write_subj_type_attribute)))

	(block mouse

		;
		; mouse contexts
		;

		(filecon "/dev/input/js([0-9]+)?" char dev_file_context)
		(filecon "/dev/input/mice" char dev_file_context)
		(filecon "/dev/input/mouse([0-9]+)?" char dev_file_context)

		;
		; mouse macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "js0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "js1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "js2"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "mouse0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "mouse1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "mouse2")))

		;
		; mouse policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block null

		;
		; null contexts
		;

		(filecon "/dev/full" char isid_context)
		(filecon "/dev/null" char isid_context)

		(sidcontext devnull isid_context)

		;
		; null macros
		;

		(macro create_subj_type ((type ARG1))
			(typeattributeset create_subj_type_attribute
				ARG1))

		(macro getattr_subj_type ((type ARG1))
			(typeattributeset getattr_subj_type_attribute
				ARG1))

		(macro manage_subj_type ((type ARG1))
			(typeattributeset manage_subj_type_attribute
				ARG1))

		(macro read_subj_type ((type ARG1))
			(typeattributeset read_subj_type_attribute
				ARG1))

		(macro relabel_subj_type ((type ARG1))
			(typeattributeset relabel_subj_type_attribute
				ARG1))

		(macro rw_subj_type ((type ARG1))
			(typeattributeset rw_subj_type_attribute
				ARG1))

		(macro setattr_subj_type ((type ARG1))
			(typeattributeset setattr_subj_type_attribute
				ARG1))

		(macro tmpfs_obj_type_transition ((type ARG1))
			(call fs.tmpfs.obj_type_transition (ARG1 isid
				chr_file "full"))
			(call fs.tmpfs.obj_type_transition (ARG1 isid
				chr_file "null")))

		(macro write_subj_type ((type ARG1))
			(typeattributeset write_subj_type_attribute
				ARG1))

		;
		; null policy
		;

		(blockinherit sys.isid_stub)

		(call dev.dev_obj_type (isid))

		(typeattribute create_subj_type_attribute)
		(typeattribute getattr_subj_type_attribute)
		(typeattribute manage_subj_type_attribute)
		(typeattribute read_subj_type_attribute)
		(typeattribute relabel_subj_type_attribute)
		(typeattribute rw_subj_type_attribute)
		(typeattribute setattr_subj_type_attribute)
		(typeattribute write_subj_type_attribute)

		(call fs.devtmpfs.search_subj_type
			(create_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(getattr_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(manage_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(read_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(relabel_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (rw_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(setattr_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (write_subj_type_attribute))

		(allow create_subj_type_attribute self (capability (mknod)))
		(allow create_subj_type_attribute isid create_chr_file_perms)
		(allow getattr_subj_type_attribute isid (chr_file (getattr)))
		(allow manage_subj_type_attribute isid manage_chr_file_perms)
		(allow read_subj_type_attribute isid read_chr_file_perms)
		(allow relabel_subj_type_attribute isid relabel_chr_file_perms)
		(allow rw_subj_type_attribute isid rw_chr_file_perms)
		(allow setattr_subj_type_attribute isid (chr_file (setattr)))
		(allow write_subj_type_attribute isid write_chr_file_perms))

	(block nvram

		;
		; nvram contexts
		;

		(filecon "/dev/ndctl([0-9]+)?" char dev_file_context)
		(filecon "/dev/nvram" char dev_file_context)

		;
		; nvram macros
		;

		;
		; nvram policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block pm_qos_misc

		;
		; pm_qos_misc contexts
		;

		(filecon "/dev/cpu_dma_latency" char dev_file_context)
		(filecon "/dev/memory_bandwidth" char dev_file_context)
		(filecon "/dev/network_latency" char dev_file_context)
		(filecon "/dev/network_throughput" char dev_file_context)

		;
		; pm_qos_misc macros
		;

		;
		; pm_qos_misc policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block ppp

		;
		; ppp contexts
		;

		(filecon "/dev/ppp" char dev_file_context)

		;
		; ppp macros
		;

		;
		; ppp policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block printer

		;
		; printer contexts
		;

		(filecon "/dev/lp([0-9]+)?" char dev_file_context)
		(filecon "/dev/parport([0-9]+)?" char dev_file_context)

		;
		; printer macros
		;

		;
		; printer policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block ptmx

		;
		; ptmx contexts
		;

		(filecon "/dev/ptmx" char dev_file_context)

		;
		; ptmx macros
		;

		;
		; ptmx policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block random

		;
		; random contexts
		;

		(filecon "/dev/hwrng" char dev_file_context)
		(filecon "/dev/random" char dev_file_context)

		;
		; random macros
		;

		(macro tmpfs_obj_type_transition ((type ARG1))
			(call fs.tmpfs.obj_type_transition (ARG1 dev
				chr_file "hwrng"))
			(call fs.tmpfs.obj_type_transition (ARG1 dev
				chr_file "random")))

		;
		; random policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block sound

		;
		; sound contexts
		;

		(filecon "/dev/snd/.+" char dev_file_context)

		;
		; sound macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hwC0D0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hwC1D0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hwC0D3"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC0D0c"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC0D0p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC0D3p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC0D7p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC0D8p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC1D0c"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC1D0p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC1D3p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC1D7p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC1D8p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC1D9p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC2D0c"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "pcmC2D0p"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "controlC0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "controlC1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "controlC2"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "controlC29")))

		;
		; sound policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block tpm

		;
		; tpm contexts
		;

		(filecon "/dev/tpm([0-9]+)?" char dev_file_context)

		;
		; tpm macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "tpm0")))

		;
		; tpm policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block tun_tap

		;
		; tun_tap contexts
		;

		(filecon "/dev/net/tun" char dev_file_context)

		;
		; tun_tap macros
		;

		;
		; tun_tap policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block uhid

		;
		; uhid contexts
		;

		(filecon "/dev/uhid" char dev_file_context)

		;
		; uhid macros
		;

		;
		; uhid policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block urandom

		;
		; urandom contexts
		;

		(filecon "/dev/urandom" char dev_file_context)

		;
		; urandom macros
		;

		(macro tmpfs_obj_type_transition ((type ARG1))
			(call fs.tmpfs.obj_type_transition (ARG1 dev
				chr_file "urandom")))

		;
		; urandom policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block usb

		;
		; usb contexts
		;

		(filecon "/dev/bus/usb/.+" char dev_file_context)
		(filecon "/dev/hidraw[0-9]+" char dev_file_context)
		(filecon "/dev/usb.+" char dev_file_context)

		;
		; usb macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "001"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "002"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "003"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "004"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "005"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "006"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "007"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "008"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "009"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "010"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "011"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "012"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "013"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "014"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "016"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "017"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "018"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "019"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "020"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "021"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "022"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "023"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "024"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "025"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "026"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "027"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "028"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "029"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "030"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "031"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "032"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "033"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "034"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "035"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "036"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "037"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "038"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "039"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "040"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "041"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "042"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "043"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "044"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "045"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "046"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "047"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "048"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "049"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "050"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hiddev0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hiddev1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hiddev2"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hiddev3"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hidraw0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hidraw1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hidraw2"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "hidraw3")))

		;
		; usb policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block usbmon

		;
		; usbmon contexts
		;

		(filecon "/dev/usbmon[0-9]+" char dev_file_context)

		;
		; usbmon macros
		;

		;
		; usbmon policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block v4l

		;
		; v4l contexts
		;

		(filecon "/dev/media([0-9]+)?" char dev_file_context)
		(filecon "/dev/video([0-9]+)?" char dev_file_context)

		;
		; v4l macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "media0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "media1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "media3"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "video0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "video1"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "video2")))

		;
		; v4l policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block vfio

		;
		; vfio contexts
		;

		(filecon "/dev/vfio/.+" char dev_file_context)

		;
		; vfio macros
		;

		;
		; vfio policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block vhost

		;
		; vhost contexts
		;

		(filecon "/dev/vhci" char dev_file_context)
		(filecon "/dev/vhost-net" char dev_file_context)

		;
		; vhost macros
		;

		;
		; vhost policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block watchdog

		;
		; watchdog contexts
		;

		(filecon "/dev/watchdog([0-9]+)?" char dev_file_context)

		;
		; watchdog macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "watchdog"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "watchdog0"))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "watchdog1")))

		;
		; watchdog policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block wireless

		;
		; wireless contexts
		;

		(filecon "/dev/rfkill" char dev_file_context)

		;
		; wireless macros
		;

		(macro devtmpfs_obj_type_transition ((type ARG1))
			(call fs.devtmpfs.obj_type_transition (ARG1 dev
				chr_file "rfkill")))

		;
		; wireless policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block xserver_misc

		;
		; xserver_misc contexts
		;

		(filecon "/dev/vga_arbiter" char dev_file_context)

		;
		; xserver_misc macros
		;

		;
		; xserver_misc policy
		;

		(blockinherit dev.dev_obj_base_template))

	(block zero

		;
		; zero contexts
		;

		(filecon "/dev/zero" char dev_file_context)

		;
		; zero macros
		;

		(macro tmpfs_obj_type_transition ((type ARG1))
			(call fs.tmpfs.obj_type_transition (ARG1 dev
				chr_file "zero")))

		;
		; zero policy
		;

		(blockinherit dev.dev_obj_base_template))

	;
	; Templates
	;

	(block dev_obj_stub

		;
		; dev_obj_stub contexts
		;

		(context dev_file_context (sys.id sys.role dev (systemlow
			systemlow)))

		;
		; dev_obj_stub policy
		;

		(blockabstract dev_obj_stub)

		(type dev)
		(call dev_obj_type (dev)))

	(block dev_obj_base_template

		;
		; dev_obj_base_template contexts
		;

		;
		; dev_obj_base_template macros
		;

		(macro create_subj_type ((type ARG1))
			(typeattributeset create_subj_type_attribute
				ARG1))

		(macro getattr_subj_type ((type ARG1))
			(typeattributeset getattr_subj_type_attribute
				ARG1))

		(macro manage_subj_type ((type ARG1))
			(typeattributeset manage_subj_type_attribute
				ARG1))

		(macro read_subj_type ((type ARG1))
			(typeattributeset read_subj_type_attribute
				ARG1))

		(macro relabel_subj_type ((type ARG1))
			(typeattributeset relabel_subj_type_attribute
				ARG1))

		(macro rw_subj_type ((type ARG1))
			(typeattributeset rw_subj_type_attribute
				ARG1))

		(macro setattr_subj_type ((type ARG1))
			(typeattributeset setattr_subj_type_attribute
				ARG1))

		(macro write_subj_type ((type ARG1))
			(typeattributeset write_subj_type_attribute
				ARG1))

		;
		; dev_obj_base_template policy
		;

		(blockabstract dev_obj_base_template)

		(blockinherit dev_obj_stub)

		(typeattribute create_subj_type_attribute)
		(typeattribute getattr_subj_type_attribute)
		(typeattribute manage_subj_type_attribute)
		(typeattribute read_subj_type_attribute)
		(typeattribute relabel_subj_type_attribute)
		(typeattribute rw_subj_type_attribute)
		(typeattribute setattr_subj_type_attribute)
		(typeattribute write_subj_type_attribute)

		(call fs.devtmpfs.search_subj_type
			(create_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(getattr_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(manage_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (read_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(relabel_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (rw_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(setattr_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (write_subj_type_attribute))

		(allow create_subj_type_attribute self (capability (mknod)))
		(allow create_subj_type_attribute dev create_chr_file_perms)
		(allow getattr_subj_type_attribute dev (chr_file (getattr)))
		(allow manage_subj_type_attribute self (capability (mknod)))
		(allow manage_subj_type_attribute dev manage_chr_file_perms)
		(allow read_subj_type_attribute dev read_chr_file_perms)
		(allow relabel_subj_type_attribute dev relabel_chr_file_perms)
		(allow rw_subj_type_attribute dev rw_chr_file_perms)
		(allow setattr_subj_type_attribute dev (chr_file (setattr)))
		(allow write_subj_type_attribute dev write_chr_file_perms))

	(block stor_obj_stub

		;
		; stor_obj_stub contexts
		;

		(context stor_dev_file_context (sys.id sys.role stor_dev
			(systemlow systemlow)))

		;
		; stor_obj_stub policy
		;

		(blockabstract stor_obj_stub)

		(type stor_dev)
		(call stor_obj_type (stor_dev)))

	(block stor_obj_base_template

		;
		; stor_obj_base_template contexts
		;

		;
		; stor_dev_obj_base_template macros
		;

		(macro create_subj_type ((type ARG1))
			(typeattributeset create_subj_type_attribute
				ARG1))

		(macro getattr_subj_type ((type ARG1))
			(typeattributeset getattr_subj_type_attribute
				ARG1))

		(macro manage_subj_type ((type ARG1))
			(typeattributeset manage_subj_type_attribute
				ARG1))

		(macro read_subj_type ((type ARG1))
			(typeattributeset read_subj_type_attribute
				ARG1))

		(macro relabel_subj_type ((type ARG1))
			(typeattributeset relabel_subj_type_attribute
				ARG1))

		(macro rw_subj_type ((type ARG1))
			(typeattributeset rw_subj_type_attribute
				ARG1))

		(macro setattr_subj_type ((type ARG1))
			(typeattributeset setattr_subj_type_attribute
				ARG1))

		(macro write_subj_type ((type ARG1))
			(typeattributeset write_subj_type_attribute
				ARG1))

		;
		; stor_obj_base_template policy
		;

		(blockabstract stor_obj_base_template)

		(blockinherit stor_obj_stub)

		(typeattribute create_subj_type_attribute)
		(typeattribute getattr_subj_type_attribute)
		(typeattribute manage_subj_type_attribute)
		(typeattribute read_subj_type_attribute)
		(typeattribute relabel_subj_type_attribute)
		(typeattribute rw_subj_type_attribute)
		(typeattribute setattr_subj_type_attribute)
		(typeattribute write_subj_type_attribute)

		(call fs.devtmpfs.read_lnk_files_subj_type
			(create_subj_type_attribute))
		(call fs.devtmpfs.read_lnk_files_subj_type
			(getattr_subj_type_attribute))
		(call fs.devtmpfs.read_lnk_files_subj_type
			(manage_subj_type_attribute))
		(call fs.devtmpfs.read_lnk_files_subj_type
			(read_subj_type_attribute))
		(call fs.devtmpfs.read_lnk_files_subj_type
			(relabel_subj_type_attribute))
		(call fs.devtmpfs.read_lnk_files_subj_type
			(rw_subj_type_attribute))
		(call fs.devtmpfs.read_lnk_files_subj_type
			(setattr_subj_type_attribute))
		(call fs.devtmpfs.read_lnk_files_subj_type
			(write_subj_type_attribute))

		(allow create_subj_type_attribute self (capability
			(mknod)))
		(allow create_subj_type_attribute stor_dev
			(chr_and_blk_files (create)))
		(allow getattr_subj_type_attribute stor_dev
			(chr_and_blk_files (getattr)))
		(allow manage_subj_type_attribute self (capability
			(mknod)))
		(allow manage_subj_type_attribute stor_dev
			(chr_and_blk_files (manage)))
		(allow read_subj_type_attribute stor_dev
			(chr_and_blk_files (read)))
		(allow relabel_subj_type_attribute stor_dev
			(chr_and_blk_files (relabel)))
		(allow rw_subj_type_attribute stor_dev
			(chr_and_blk_files (rw)))
		(allow setattr_subj_type_attribute stor_dev
			(chr_and_blk_files (setattr)))
		(allow write_subj_type_attribute stor_dev
			(chr_and_blk_files (write)))

		(optional stor_obj_base_template_optional_stor
			(allow stor.unconfined_subj_type_attribute stor_dev
				blk_file_except_mounton_and_execmod)
			(allow stor.unconfined_subj_type_attribute stor_dev
				chr_file_except_mounton_and_execmod)

			(call create_subj_type
				(stor.create_all_subj_type_attribute))
			(call getattr_subj_type
				(stor.getattr_all_subj_type_attribute))
			(call manage_subj_type
				(stor.manage_all_subj_type_attribute))
			(call read_subj_type
				(stor.read_all_subj_type_attribute))
			(call relabel_subj_type
				(stor.relabel_all_subj_type_attribute))
			(call rw_subj_type (stor.rw_all_subj_type_attribute))
			(call setattr_subj_type
				(stor.setattr_all_subj_type_attribute))
			(call write_subj_type
				(stor.write_all_subj_type_attribute))))

	(block login_pty_obj_stub

		;
		; login_pty_obj_stub policy
		;

		(blockabstract login_pty_obj_stub)

		(type login_pty_dev)
		(call login_pty_obj_type (login_pty_dev)))

	(block login_pty_obj_base_template

		;
		; login_pty_obj_base_template macros
		;

		(macro getattr_subj_type ((type ARG1))
			(typeattributeset getattr_subj_type_attribute
				ARG1))

		(macro manage_subj_type ((type ARG1))
			(typeattributeset manage_subj_type_attribute
				ARG1))

		(macro read_subj_type ((type ARG1))
			(typeattributeset read_subj_type_attribute
				ARG1))

		(macro relabel_subj_type ((type ARG1))
			(typeattributeset relabel_subj_type_attribute
				ARG1))

		(macro relabelfrom_subj_type ((type ARG1))
			(typeattributeset relabelfrom_subj_type_attribute
				ARG1))

		(macro relabelto_subj_type ((type ARG1))
			(typeattributeset relabelto_subj_type_attribute
				ARG1))

		(macro rw_inherited_subj_type ((type ARG1))
			(typeattributeset rw_inherited_subj_type_attribute
				ARG1))

		(macro rw_subj_type ((type ARG1))
			(typeattributeset rw_subj_type_attribute
				ARG1))

		(macro setattr_subj_type ((type ARG1))
			(typeattributeset setattr_subj_type_attribute
				ARG1))

		(macro write_subj_type ((type ARG1))
			(typeattributeset write_subj_type_attribute
				ARG1))

		;
		; login_pty_obj_base_template policy
		;

		(blockabstract login_pty_obj_base_template)

		(blockinherit login_pty_obj_stub)

		(typeattribute getattr_subj_type_attribute)
		(typeattribute manage_subj_type_attribute)
		(typeattribute read_subj_type_attribute)
		(typeattribute relabel_subj_type_attribute)
		(typeattribute relabelfrom_subj_type_attribute)
		(typeattribute relabelto_subj_type_attribute)
		(typeattribute rw_inherited_subj_type_attribute)
		(typeattribute rw_subj_type_attribute)
		(typeattribute setattr_subj_type_attribute)
		(typeattribute write_subj_type_attribute)

		(call fs.devpts.search_subj_type (getattr_subj_type_attribute))
		(call fs.devpts.search_subj_type (manage_subj_type_attribute))
		(call fs.devpts.search_subj_type (read_subj_type_attribute))
		(call fs.devpts.search_subj_type (relabel_subj_type_attribute))
		(call fs.devpts.search_subj_type
			(relabelfrom_subj_type_attribute))
		(call fs.devpts.search_subj_type
			(relabelto_subj_type_attribute))
		(call fs.devpts.search_subj_type
			(rw_inherited_subj_type_attribute))
		(call fs.devpts.search_subj_type (rw_subj_type_attribute))
		(call fs.devpts.search_subj_type (setattr_subj_type_attribute))
		(call fs.devpts.search_subj_type (write_subj_type_attribute))

		(allow getattr_subj_type_attribute login_pty_dev (chr_file
			(getattr)))
		(allow manage_subj_type_attribute login_pty_dev
			manage_chr_file_perms)
		(allow read_subj_type_attribute login_pty_dev
			read_chr_file_perms)
		(allow relabel_subj_type_attribute login_pty_dev
			relabel_chr_file_perms)
		(allow relabelfrom_subj_type_attribute login_pty_dev
			relabelfrom_chr_file_perms)
		(allow relabelto_subj_type_attribute login_pty_dev
			relabelto_chr_file_perms)
		(allow rw_inherited_subj_type_attribute login_pty_dev
			rw_inherited_term_perms)
		(allow rw_subj_type_attribute login_pty_dev rw_term_perms)
		(allow setattr_subj_type_attribute login_pty_dev (chr_file
			(setattr)))
		(allow write_subj_type_attribute login_pty_dev
			write_chr_file_perms)

		(allow term.unconfined_subj_type_attribute login_pty_dev
			chr_file_except_mounton_and_execmod)

		(call getattr_subj_type (term.getattr_all_subj_type_attribute))
		(call manage_subj_type (term.manage_all_subj_type_attribute))
		(call read_subj_type (term.read_all_subj_type_attribute))
		(call relabel_subj_type (term.relabel_all_subj_type_attribute))
		(call relabelfrom_subj_type
			(term.relabelfrom_all_subj_type_attribute))
		(call relabelto_subj_type
			(term.relabelto_all_subj_type_attribute))
		(call rw_inherited_subj_type
			(term.rw_all_inherited_subj_type_attribute))
		(call rw_subj_type (term.rw_all_subj_type_attribute))
		(call setattr_subj_type (term.setattr_all_subj_type_attribute))
		(call write_subj_type (term.write_all_subj_type_attribute)))

	(block pty_obj_stub

		;
		; pty_obj_stub policy
		;

		(blockabstract pty_obj_stub)

		(type pty_dev)
		(call pty_obj_type (pty_dev)))

	(block pty_obj_base_template

		;
		; pty_obj_base_template macros
		;

		(macro create_pty ((type ARG1)(type ARG2))
			(call dev.ptmx.rw_subj_type (ARG1))
			(call fs.devpts.getattr_subj_type (ARG1))
			(call fs.devpts.obj_type_transition (ARG1 ARG2
				chr_file "*")))

		(macro getattr_subj_type ((type ARG1))
			(typeattributeset getattr_subj_type_attribute
				ARG1))

		(macro manage_subj_type ((type ARG1))
			(typeattributeset manage_subj_type_attribute
				ARG1))

		(macro read_subj_type ((type ARG1))
			(typeattributeset read_subj_type_attribute
				ARG1))

		(macro relabel_subj_type ((type ARG1))
			(typeattributeset relabel_subj_type_attribute
				ARG1))

		(macro relabelfrom_subj_type ((type ARG1))
			(typeattributeset relabelfrom_subj_type_attribute
				ARG1))

		(macro relabelto_subj_type ((type ARG1))
			(typeattributeset relabelto_subj_type_attribute
				ARG1))

		(macro rw_inherited_subj_type ((type ARG1))
			(typeattributeset rw_inherited_subj_type_attribute
				ARG1))

		(macro rw_subj_type ((type ARG1))
			(typeattributeset rw_subj_type_attribute
				ARG1))

		(macro setattr_subj_type ((type ARG1))
			(typeattributeset setattr_subj_type_attribute
				ARG1))

		(macro write_subj_type ((type ARG1))
			(typeattributeset write_subj_type_attribute
				ARG1))

		;
		; pty_obj_base_template policy
		;

		(blockabstract pty_obj_base_template)

		(blockinherit pty_obj_stub)

		(typeattribute getattr_subj_type_attribute)
		(typeattribute manage_subj_type_attribute)
		(typeattribute read_subj_type_attribute)
		(typeattribute relabel_subj_type_attribute)
		(typeattribute relabelfrom_subj_type_attribute)
		(typeattribute relabelto_subj_type_attribute)
		(typeattribute rw_inherited_subj_type_attribute)
		(typeattribute rw_subj_type_attribute)
		(typeattribute setattr_subj_type_attribute)
		(typeattribute write_subj_type_attribute)

		(call fs.devpts.search_subj_type (getattr_subj_type_attribute))
		(call fs.devpts.search_subj_type (manage_subj_type_attribute))
		(call fs.devpts.search_subj_type (read_subj_type_attribute))
		(call fs.devpts.search_subj_type
			(relabel_subj_type_attribute))
		(call fs.devpts.search_subj_type
			(relabelfrom_subj_type_attribute))
		(call fs.devpts.search_subj_type
			(relabelto_subj_type_attribute))
		(call fs.devpts.search_subj_type
			(rw_inherited_subj_type_attribute))
		(call fs.devpts.search_subj_type (rw_subj_type_attribute))
		(call fs.devpts.search_subj_type (setattr_subj_type_attribute))
		(call fs.devpts.search_subj_type (write_subj_type_attribute))

		(allow getattr_subj_type_attribute pty_dev (chr_file
			(getattr)))
		(allow manage_subj_type_attribute pty_dev
			manage_chr_file_perms)
		(allow read_subj_type_attribute pty_dev read_chr_file_perms)
		(allow relabel_subj_type_attribute pty_dev
			relabel_chr_file_perms)
		(allow relabelfrom_subj_type_attribute pty_dev
			relabelfrom_chr_file_perms)
		(allow relabelto_subj_type_attribute pty_dev
			relabelto_chr_file_perms)
		(allow rw_inherited_subj_type_attribute pty_dev
			rw_inherited_term_perms)
		(allow rw_subj_type_attribute pty_dev rw_term_perms)
		(allow setattr_subj_type_attribute pty_dev (chr_file
			(setattr)))
		(allow write_subj_type_attribute pty_dev write_chr_file_perms)

		(allow term.unconfined_subj_type_attribute pty_dev
			chr_file_except_mounton_and_execmod)

		(call getattr_subj_type (term.getattr_all_subj_type_attribute))
		(call manage_subj_type (term.manage_all_subj_type_attribute))
		(call read_subj_type (term.read_all_subj_type_attribute))
		(call relabel_subj_type (term.relabel_all_subj_type_attribute))
		(call relabelfrom_subj_type
			(term.relabelfrom_all_subj_type_attribute))
		(call relabelto_subj_type
			(term.relabelto_all_subj_type_attribute))
		(call rw_inherited_subj_type
			(term.rw_all_inherited_subj_type_attribute))
		(call rw_subj_type (term.rw_all_subj_type_attribute))
		(call setattr_subj_type (term.setattr_all_subj_type_attribute))
		(call write_subj_type (term.write_all_subj_type_attribute)))

	(block serial_obj_stub

		;
		; serial_obj_stub contexts
		;

		(context serial_file_context (sys.id sys.role serial_dev
			(systemlow systemlow)))

		;
		; serial_obj_stub policy
		;

		(blockabstract serial_obj_stub)

		(type serial_dev)
		(call serial_obj_type (serial_dev)))

	(block serial_obj_base_template

		;
		; serial_obj_base_template contexts
		;

		;
		; serial_obj_base_template macros
		;

		(macro getattr_subj_type ((type ARG1))
			(typeattributeset getattr_subj_type_attribute
				ARG1))

		(macro manage_subj_type ((type ARG1))
			(typeattributeset manage_subj_type_attribute
				ARG1))

		(macro read_subj_type ((type ARG1))
			(typeattributeset read_subj_type_attribute
				ARG1))

		(macro relabel_subj_type ((type ARG1))
			(typeattributeset relabel_subj_type_attribute
				ARG1))

		(macro relabelfrom_subj_type ((type ARG1))
			(typeattributeset relabelfrom_subj_type_attribute
				ARG1))

		(macro relabelto_subj_type ((type ARG1))
			(typeattributeset relabelto_subj_type_attribute
				ARG1))

		(macro rw_inherited_subj_type ((type ARG1))
			(typeattributeset rw_inherited_subj_type_attribute
				ARG1))

		(macro rw_subj_type ((type ARG1))
			(typeattributeset rw_subj_type_attribute
				ARG1))

		(macro setattr_subj_type ((type ARG1))
			(typeattributeset setattr_subj_type_attribute
				ARG1))

		(macro write_subj_type ((type ARG1))
			(typeattributeset write_subj_type_attribute
				ARG1))

		;
		; serial_obj_base_template policy
		;

		(blockabstract serial_obj_base_template)

		(blockinherit serial_obj_stub)

		(typeattribute getattr_subj_type_attribute)
		(typeattribute manage_subj_type_attribute)
		(typeattribute read_subj_type_attribute)
		(typeattribute relabel_subj_type_attribute)
		(typeattribute relabelfrom_subj_type_attribute)
		(typeattribute relabelto_subj_type_attribute)
		(typeattribute rw_inherited_subj_type_attribute)
		(typeattribute rw_subj_type_attribute)
		(typeattribute setattr_subj_type_attribute)
		(typeattribute write_subj_type_attribute)

		(call fs.devtmpfs.search_subj_type
			(getattr_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(manage_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (read_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(relabel_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(relabelfrom_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(relabelto_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(rw_inherited_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (rw_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type
			(setattr_subj_type_attribute))
		(call fs.devtmpfs.search_subj_type (write_subj_type_attribute))

		(allow getattr_subj_type_attribute serial_dev (chr_file
			(getattr)))
		(allow manage_subj_type_attribute serial_dev
			manage_chr_file_perms)
		(allow read_subj_type_attribute serial_dev read_chr_file_perms)
		(allow relabel_subj_type_attribute serial_dev
			relabel_chr_file_perms)
		(allow relabelfrom_subj_type_attribute serial_dev
			relabelfrom_chr_file_perms)
		(allow relabelto_subj_type_attribute serial_dev
			relabelto_chr_file_perms)
		(allow rw_inherited_subj_type_attribute serial_dev
			rw_inherited_term_perms)
		(allow rw_subj_type_attribute serial_dev rw_term_perms)
		(allow setattr_subj_type_attribute serial_dev (chr_file
			(setattr)))
		(allow write_subj_type_attribute serial_dev
			write_chr_file_perms)

		(allow term.unconfined_subj_type_attribute serial_dev
			chr_file_except_mounton_and_execmod)

		(call getattr_subj_type (term.getattr_all_subj_type_attribute))
		(call manage_subj_type (term.manage_all_subj_type_attribute))
		(call read_subj_type (term.read_all_subj_type_attribute))
		(call relabel_subj_type (term.relabel_all_subj_type_attribute))
		(call relabelfrom_subj_type
			(term.relabelfrom_all_subj_type_attribute))
		(call relabelto_subj_type
			(term.relabelto_all_subj_type_attribute))
		(call rw_inherited_subj_type
			(term.rw_all_inherited_subj_type_attribute))
		(call rw_subj_type (term.rw_all_subj_type_attribute))
		(call setattr_subj_type (term.setattr_all_subj_type_attribute))
		(call write_subj_type (term.write_all_subj_type_attribute))))
